stages:
  - build
  - style
  - test

build_simple_bash_utils:
  stage: build
  tags:
    - build
  script:
    - cd src/cat && make s21_cat
    - cd ../grep && make s21_grep
  artifacts:
    paths:
      - src/cat/s21_cat
      - src/grep/s21_grep
    expire_in: 30 days

style-test:
  stage: style
  tags:
    - style
  script:
    - cd src
    - ./test_style.sh

integratin-tests:
  stage: test
  tags:
    - test
  script:
    - echo "========================"
    - echo "Проверка тестов в папке cat:"
    - echo "..."
    - cd src/cat
    - make test || { echo "Ошибка! Тесты для cat не прошли!"; exit 1; }
    - echo "========================"
    - echo "Проверка тестов в папке grep:"
    - echo "..."
    - cd ../grep
    - make test || { echo "Ошибка! Тесты для grep не прошли!"; exit 1; }
  when: on_success

